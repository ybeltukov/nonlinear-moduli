def P0(K0, mu0, K1, mu1):
    return [[(-1701*K0**4*(3*mu0 + 2*mu1)**3 + 378*K0**3*(3*mu0 + 2*mu1)**2*(9*K1*mu0 - 42*mu0**2 + 6*K1*mu1 - 58*mu0*mu1) + 2016*K0*mu0**2*(2*mu0 + 3*mu1)**2*(-10*mu0*(mu0 + mu1) + K1*(9*mu0 + 6*mu1)) + 1512*K0**2*mu0*(3*mu0 + 2*mu1)*(2*mu0 + 3*mu1)*(K1*(9*mu0 + 6*mu1) - 2*mu0*(9*mu0 + 11*mu1)) + 32*mu0**3*(-4*mu0*(87*mu0**3 + 579*mu0**2*mu1 + 681*mu0*mu1**2 + 403*mu1**3) + 3*K1*(249*mu0**3 + 933*mu0**2*mu1 + 1587*mu0*mu1**2 + 731*mu1**3)))/(7*(3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
             ((81*K0*mu0*(459*K0*K1**2 + 12*K1*(-178*K0 + 69*K1)*mu0 + 16*(37*K0 - 114*K1)*mu0**2 - 320*mu0**3))/(3*K1 + 4*mu0)**2 + (28*(243*K0**3*(K0 - K1)**2 + 1458*K0**3*(K0 - 2*K1)*mu0 + 2916*K0**3*mu0**2 + 1359*K1**2*mu0**3 - 1560*K1*mu0**4 - 1040*mu0**5))/(3*K1 + 4*mu0)**2 - (625*mu0**4*(3*K0 + 4*mu0)**3*(-9*K0**2 + 12*K0*mu0 + 20*mu0**2))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3 - (375*mu0**3*(3*K0 + 4*mu0)**2*(33*K0**2 + 100*K0*mu0 + 108*mu0**2))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**2 + (75*mu0**2*(3*K0 + 4*mu0)*(57*K0**2 + 212*K0*mu0 + 236*mu0**2))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1))/(378*(K0 + 2*mu0)**3),
             ((3*K0 + 4*mu0)**2*(-189*K0**4*(3*mu0 + 2*mu1)**3 - 5040*K0**2*mu0**2*(mu0 + mu1)*(3*mu0 + 2*mu1)*(2*mu0 + 3*mu1) - 252*K0**3*mu0*(3*mu0 + 2*mu1)**2*(9*mu0 + 11*mu1) + mu0*(64*mu0**3*(mu0 - mu1)*(617*mu0**2 + 1006*mu0*mu1 + 477*mu1**2) + 225*K1**3*(83*mu0**3 + 87*mu0**2*mu1 - 3*mu0*mu1**2 - 27*mu1**3) + 900*K1**2*mu0*(83*mu0**3 + 87*mu0**2*mu1 - 3*mu0*mu1**2 - 27*mu1**3) + 1200*K1*mu0**2*(83*mu0**3 + 87*mu0**2*mu1 - 3*mu0*mu1**2 - 27*mu1**3)) + 3*K0*(64*mu0**3*(64*mu0**3 - 192*mu0**2*mu1 - 508*mu0*mu1**2 - 239*mu1**3) + 225*K1**3*(20*mu0**3 + 24*mu0**2*mu1 - 3*mu0*mu1**2 - 6*mu1**3) + 900*K1**2*mu0*(20*mu0**3 + 24*mu0**2*mu1 - 3*mu0*mu1**2 - 6*mu1**3) + 1200*K1*mu0**2*(20*mu0**3 + 24*mu0**2*mu1 - 3*mu0*mu1**2 - 6*mu1**3))))/(21*(3*K1 + 4*mu0)**3*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3)],
            [(120*mu0**2*(mu0 - mu1)**2*(63*K0*mu0 + 46*mu0**2 + 42*K0*mu1 + 94*mu0*mu1))/(7*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
             -(567*K0**4*(3*mu0 + 2*mu1)**3 + 378*K0**3*(3*mu0 + 2*mu1)*(3*K1*(mu0 - mu1)*(3*mu0 + 7*mu1) + 2*mu0*(4*mu0 + mu1)*(7*mu0 + 13*mu1)) + 12*K0*mu0**2*(3*K1*(mu0 - mu1)*(907*mu0**2 + 7341*mu0*mu1 + 5752*mu1**2) + 4*mu0*(1684*mu0**3 + 9493*mu0**2*mu1 + 4662*mu0*mu1**2 - 1839*mu1**3)) + 8*mu0**3*(-3*K1*(mu0 - mu1)*(223*mu0**2 - 4556*mu0*mu1 - 6867*mu1**2) + 20*mu0*(17*mu0**3 + 1149*mu0**2*mu1 + 1011*mu0*mu1**2 - 777*mu1**3)) + 18*K0**2*mu0*(3*K1*(mu0 - mu1)*(969*mu0**2 + 2872*mu0*mu1 + 1759*mu1**2) + 2*mu0*(3653*mu0**3 + 10386*mu0**2*mu1 + 6769*mu0*mu1**2 + 192*mu1**3)))/(7*(3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
             (5*(3*K0 + 4*mu0)**2*(mu0**3*(9*K0*(84*K0 - 121*K1) + 3*(76*K0 - 471*K1)*mu0 - 988*mu0**2) + mu0**2*(882*K0**2 - 828*K0*K1 + 1416*K0*mu0 - 1221*K1*mu0 + 164*mu0**2)*mu1 + mu0*(63*K0**2 + 198*K0*K1 + 684*K0*mu0 + 381*K1*mu0 + 956*mu0**2)*mu1**2 - 3*(42*K0**2 - 48*K0*K1 + 76*K0*mu0 - 51*K1*mu0 + 44*mu0**2)*mu1**3))/(42*(3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3)],
            [(-7200*mu0**3*(mu0 - mu1)**3)/(7*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
             (180*mu0*(mu0 - mu1)**2*(9*K0**2*(11*mu0 + 9*mu1) + 36*K0*mu0*(11*mu0 + 9*mu1) + 4*mu0**2*(69*mu0 + 91*mu1)))/(7*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
             (-25*(3*K0 + 4*mu0)**2*(mu0**3*(60*K0 + 83*mu0) + 3*mu0**2*(24*K0 + 29*mu0)*mu1 - 3*mu0*(3*K0 + mu0)*mu1**2 - 9*(2*K0 + 3*mu0)*mu1**3))/(7*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3)]]

def P1(K0, mu0, K1, mu1):
    return [[(3*K0 + 4*mu0)**3/(3*K1 + 4*mu0)**3,
             0,
             ((3*K0 + 4*mu0)**3*((3*K1 + 4*mu0)**(-3) - (125*mu0**3)/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3))/9],
            [0,
             (25*mu0**2*(3*K0 + 4*mu0)**3)/((3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**2),
             (25*mu0**2*(3*K0 + 4*mu0)**3*(mu0*(-3*K0 + 5*K1 + 4*mu0) - 2*(K0 + 2*mu0)*mu1))/(2*(3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3)],
            [0,
             0,
             (125*mu0**3*(3*K0 + 4*mu0)**3)/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3]]

def Q(K0, mu0, K1, mu1):
    return [((-315520*mu0**7)/(3*K1 + 4*mu0)**3 + (15309*K0**4*(3*(K0 - K1)**2*K1 + 2*(K0**2 + 8*K0*K1 - 19*K1**2)*mu0 + 12*(K0 + 2*K1)*mu0**2 + 24*mu0**3))/(3*K1 + 4*mu0)**3 + (3*mu0*(89910*K0**3*K1**3 + 81*K0**2*K1**2*(-5892*K0 + 2419*K1)*mu0 - 108*K0*K1*(600*K0**2 + 5217*K0*K1 - 1553*K1**2)*mu0**2 + 18*(2936*K0**3 - 19056*K0**2*K1 - 21696*K0*K1**2 + 2071*K1**3)*mu0**3 - 120*(968*K0**2 + 3432*K0*K1 + 1479*K1**2)*mu0**4 - 160*(1144*K0 + 1479*K1)*mu0**5))/(3*K1 + 4*mu0)**3 + (625*mu0**4*(3*K0 + 4*mu0)**3*(162*K0**3 + 585*K0**2*mu0 + 804*K0*mu0**2 + 314*mu0**3))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3 - (375*mu0**3*(3*K0 + 4*mu0)**2*(198*K0**3 + 753*K0**2*mu0 + 1108*K0*mu0**2 + 538*mu0**3))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**2 + (75*mu0**2*(3*K0 + 4*mu0)*(234*K0**3 + 921*K0**2*mu0 + 1412*K0*mu0**2 + 762*mu0**3))/(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1))/(1134*(K0 + 2*mu0)**3),
            (2*(mu0 - mu1)*(189*K0**4*(15*K1 + 7*mu0)*(mu0 - mu1)*(3*mu0 + 2*mu1) + K0*mu0**3*(7*mu0**2*(6621*K1 + 2216*mu0) + mu0*(11691*K1 + 52996*mu0)*mu1 - 6*(18073*K1 + 5818*mu0)*mu1**2) + 2*mu0**4*(20*mu0*(mu0 - mu1)*(67*mu0 + 493*mu1) + K1*(6409*mu0**2 + 2372*mu0*mu1 - 25581*mu1**2)) + 3*K0**2*mu0**2*(3*K1*(7069*mu0**2 + 682*mu0*mu1 - 9851*mu1**2) + mu0*(9271*mu0**2 + 16063*mu0*mu1 - 8534*mu1**2)) + 9*K0**3*mu0*(3*K1*(mu0 - mu1)*(1393*mu0 + 1312*mu1) + 2*mu0*(973*mu0**2 + 769*mu0*mu1 - 692*mu1**2))))/(7*(3*K1 + 4*mu0)*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3),
            (60*mu0*(mu0 - mu1)**2*(-9*K0**2*mu0*(mu0 - 121*mu1) + 270*K0**3*mu1 + 12*K0*mu0**2*(7*mu0 + 143*mu1) + 2*mu0**3*(67*mu0 + 493*mu1)))/(7*(mu0*(9*K0 + 8*mu0) + 6*(K0 + 2*mu0)*mu1)**3)]

def effective_moduli(K0, mu0, l0, m0, n0, K1, mu1, l1, m1, n1, c):
    K_eff = K0 + c*(K1 - K0)*(3*K0 + 4*mu0)/(3*K1 + 4*mu0)
    mu_eff = mu0 + c*(mu1 - mu0)*5*mu0*(3*K0 + 4*mu0)/(mu0*(9*K0 + 8*mu0) + 6*mu1*(K0 + 2*mu0))
    P0l, P0m, P0n = P0(K0, mu0, K1, mu1)
    P1l, P1m, P1n = P1(K0, mu0, K1, mu1)
    lg, mg, ng = Q(K0, mu0, K1, mu1)
    l_eff = l0 + c*(P0l[0]*l0 + P0l[1]*m0 + P0l[2]*n0 + P1l[0]*l1 + P1l[1]*m1 + P1l[2]*n1 + lg)
    m_eff = m0 + c*(P0m[0]*l0 + P0m[1]*m0 + P0m[2]*n0 + P1m[0]*l1 + P1m[1]*m1 + P1m[2]*n1 + mg)
    n_eff = n0 + c*(P0n[0]*l0 + P0n[1]*m0 + P0n[2]*n0 + P1n[0]*l1 + P1n[1]*m1 + P1n[2]*n1 + ng)
    return K_eff, mu_eff, l_eff, m_eff, n_eff
